<apex:page sidebar="false" showHeader="false" standardStylesheets="true" id="thePage" Standardcontroller="DRDW_Capability__c" extensions="DRDW_ViewActivityController">
<head>
        <title>View Activity</title>
        <c:DRDW_QFOR_Styles />
    </head>  
    <body>
        <div class='df_drdw content'>
            <!--Using QFORs Index component for the Top Header -->
            <c:DRDW_IndexNew />
            <div class="df_drdw-createstudy vertical-compress columns-compressed">
                
                <header>
                    
                    <div class="container">
                        <div class="row">
                            <div class="col-xs-12">
                                <apex:outputpanel rendered="{!IF($CurrentPage.parameters.id == NULL,true,false)}">
                                    <h1>Activity</h1>
                                    <p></p>
                                </apex:outputpanel>  
                                <apex:outputpanel rendered="{!IF($CurrentPage.parameters.id != NULL,true,false)}">
                                    <h1>{!oActivity.Title__c}</h1>
                                    <p></p>
                                </apex:outputpanel>                                                              
                            </div>
                        </div>
                    </div>
                    
                </header>
                <main class="container">


                <!-- ----------------------------  View page for Idea starts ------------------------- -->
                
                <apex:outputpanel rendered="{!IF($CurrentPage.parameters.id != NULL,true,false) && IF($CurrentPage.parameters.isEdit =='false',true,false)}">
                    
                        <apex:form Styleclass="create-study-form accordion">
                        <section class="row submit">
                                <div class="col-xs-12">
                                    <apex:outputPanel rendered="{!if(OR(isAdmin,isFin,AND(isFunctionalHead,isGroupUser),AND(isPmErl,isBUGroupUser),AND(isPmErl,isAccessable),AND(isSc,isAccessable)),true,false)}">
                                        <apex:commandButton styleClass="btn button" value="Edit" action="{!edit}"/>  
                                    </apex:outputPanel>    
                                </div>
                            </section>
                            <apex:pageMessages />
                            <section class="row">
                                <div class="col-xs-12">
                                    <h2 class="accordion-parent">Details
                                    <span class = "mandatory-fields-indicator-badge"/>
                                        <span class="icon-large-caret pull-right down"></span></h2>
                                    <fieldset class="accordion-child">
                                        
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Title__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Title__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Title__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Title__c}" styleclass="required"></apex:outputField>
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Status__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Status__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Status__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Status__c}" styleclass="required"></apex:outputField>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Capability_Area__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Capability_Area__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Capability_Area__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Capability_Area__c}"></apex:outputField>
                                            </div> 
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Capability__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Capability__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Capability__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Capability__c}"></apex:outputField>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Related_Project__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Related_Project__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Related_Project__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputLink value="{!IF(isIdea=true,'/apex/DRDW_CreateIdea?id='+oActivity.Related_Project__c+'&isEdit=false&section=#Project_Activities',IF(isGeneration=true,'/apex/DRDW_CreateGeneration?id='+oActivity.Related_Project__c+'&isEdit=false&section=#Project_Activities','/apex/DRDW_CreateAssessment?id='+oActivity.Related_Project__c+'&isEdit=false&section=#Project_Activities'))}">{!projectName}</apex:outputLink>
                                                <!-- <apex:outputField value="{!oActivity.Related_Project__c}"></apex:outputField>  -->
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>Related ERL Request</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.DRDW_Request__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.DRDW_Request__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <!-- <apex:outputField value="{!oActivity.DRDW_Request__c}"></apex:outputField> -->
                                                 <apex:outputLink value="/apex/DRDW_CreateERLRequest?id={!oActivity.DRDW_Request__c}&isEdit=false&projid={!oActivity.Related_Project__c}">{!oActivity.DRDW_Request__r.Name}</apex:outputLink>
                                                 
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Planned_Start_Date__c.Label}</label> 
                                            </div>
                                            <div class="col-xs-3 field-wrapper hide-user-select left-aligned">
                                                <apex:outputField value="{!oActivity.Planned_Start_Date__c}"/>
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Planned_End_Date__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Planned_End_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Planned_End_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper hide-user-select left-aligned">
                                                <apex:outputField value="{!oActivity.Planned_End_Date__c}" styleclass="required"></apex:outputField>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Actual_Start_Date__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Actual_Start_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Actual_Start_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Actual_Start_Date__c}"></apex:outputField>
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Actual_End_Date__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Actual_End_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Actual_End_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Actual_End_Date__c}"></apex:outputField>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>Preferred Start Date</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Proposed_Start_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Proposed_Start_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Proposed_Start_Date__c}"></apex:outputField>
                                            </div>
                                            
                                        </div>
                                    </fieldset>
                                </div>

                            
                            
                                    <div class="col-xs-12">
                                    <h2 class="accordion-parent">Related Activity Budget<span class="icon-large-caret pull-right down"></span>
                                        <a href='#Project_Budgets'/></h2>
                                    <fieldset class="accordion-child" id="Project_Budgets">
                                        <apex:outputPanel id="Budgetsection">
                                            
                                            <apex:outputpanel id="berror">
                                                <apex:outputpanel rendered="{!isbError}">
                                                    <div class="sfdc-errorMessage font-s">
                                                        <apex:pagemessages escape="false"></apex:pagemessages>
                                                    </div>
                                                </apex:outputpanel>
                                            </apex:outputpanel>
                                            <div class="accordion-content">
                                                <!--  Add new Experiment section starts -->
                                                <div class="row">
                                                    <div class="col-xs-3 label-wrapper left-aligned">
                                                        <label>Total PO Actuals</label>
                                                        <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Project__c.Fields.Total_budget__c.inlinehelptext != NULL,true,false)}">
                                                            <div class="helpOrb tooltip-sfdc">
                                                                <span>{!$ObjectType.DRDW_Capability__c.Fields.Total_budget__c.inlinehelptext}</span>
                                                            </div>          
                                                        </apex:outputpanel>      
                                                    </div>
                                                    <apex:variable var="amount" value="{!oActivity.Total_budget__c}" />
                                                    <div class="{!IF((amount!= null && amount < 0),'currency-round-off col-xs-3 field-wrapper left-aligned red-color-text','currency-round-off col-xs-3 field-wrapper left-aligned')}">
                                                        <apex:outputText value="{!oActivity.Total_budget__c}">$</apex:outputText>
                                                    </div>
                                                    <div class="col-xs-6 zero-right-padding">
                                                       <apex:outputPanel rendered="{!if(OR(isAdmin,isFin),true,false)}">                                               
                                                        <apex:commandButton styleClass="btn button btn-create-new-related-item pull-right" value="Create New Activity Budget" action="{!AddBudgetCap}"/>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-3 label-wrapper left-aligned">
                                                        <label>Total Rolling Forecast</label>
                                                         
                                                    </div>
                                                    <apex:variable var="amount" value="{!totalforecast}" />
                                                    <div class="{!IF((amount!= null && amount < 0),'currency-round-off col-xs-3 field-wrapper left-aligned red-color-text','currency-round-off col-xs-3 field-wrapper left-aligned')}">
                                                        <apex:outputText value="{!totalforecast}">$</apex:outputText>
                                                    </div>
                                                </div>
                                                <!-- </fieldset> -->
                                                <!-- Add new Experiment section ends -->
                                                
                                                <!-- Iteration unit starts -->
                                                <apex:outputpanel id="theBudgetTable">
                                                <apex:outputpanel rendered="{!lbudgets.size>0}">
                                               
                                                <apex:pageBlock >
                                                            <apex:pageBlockTable value="{!lbudgets}" var="item">
                                                                <apex:column >
                                                                    <apex:facet name="header">Budget ID</apex:facet>
                                                                    <apex:commandlink styleclass="remove-custom-data-row" value="{!item.Name}" action="{!BudgetLink}">
                                                                        <apex:param name="LinkID2" value="{!item.Id}" assignTo="{!LinkID2}" />
                                                                    </apex:commandlink>
                                                                </apex:column>
                                                               <apex:column value="{!item.Titletab__c}"/>
                                                                <apex:column value="{!item.PO__c}"/>
                                                                
                                                                <apex:column value="{!item.Vendorr__c}"/>
                                                                <apex:column value="{!item.Scientist_Owner__c}"/>
                                                                  <apex:column >
                                                                      <apex:facet name="header">Total Contract Value</apex:facet>
                                                                      <apex:variable var="amount" value="{!item.Total_Contract_Value__c}" />
                                                                        <div class="{!IF((amount!= null && amount < 0),'currency-round-off red-color-text','currency-round-off')}">
                                                                             <apex:outputText value="{!item.Total_Contract_Value__c}">$</apex:outputText>
                                                                        </div>
                                                                  </apex:column>
                                                                  <apex:column >
                                                                      <apex:facet name="header">Total Actuals</apex:facet>
                                                                      <apex:variable var="amount" value="{!item.Total_Actuals__c}" />
                                                                        <div class="{!IF((amount!= null && amount < 0),'currency-round-off red-color-text','currency-round-off')}">
                                                                             <apex:outputText value="{!item.Total_Actuals__c}">$</apex:outputText>
                                                                        </div>
                                                                  </apex:column>
                                                                  <apex:column value="{!item.Cost_Center__r.Name}"/>
                                                              <apex:column rendered="{!if(OR(isAdmin,isFin),true,false)}">
                                                                    <apex:facet name="header">Action</apex:facet>
                                                                    <apex:commandlink styleclass="remove-custom-data-row" value="remove" action="{!Removebudget}" onclick="df_drdw.globalEvents.showWaitSpinner();" oncomplete="df_drdw.globalEvents.hideWaitSpinner();" rerender="theBudgetTable,noBudget,berror,Budgetsection">
                                                                        <apex:param name="genericID" value="{!item.Id}" assignTo="{!genericID}" />
                                                                    </apex:commandlink>
                                                                </apex:column>
                                                            </apex:pageBlockTable>
                                                </apex:pageBlock>
                                                </apex:outputpanel>
                                                </apex:outputpanel>
                                                <!-- Iteration unit ends -->    

                                                <!--No Experiment section startes -->
                                                <apex:outputpanel id="noBudget">
                                                    <apex:outputpanel rendered="{!lbudgets.size==0}">
                                                    <span class="content"><strong>No Activity Budget</strong></span>
                                                    </apex:outputpanel>
                                                </apex:outputpanel>   

                                                <!-- No Experiment section ends -->
                                            </div>    
                                        </apex:outputpanel> 
                                    </fieldset>
                                </div>
                                        
                                        
                                        
                             </section>

                            <!-------------- Related Evaluation Project starts ---------------- -->
                                <!-- <div class = "create-study-form accordion outside-form-section" > -->
                               
                                        <section class="row">
                                                <div class="col-xs-12">
                                                    <h2 class="accordion-parent">Resource Allocation<span class="icon-large-caret pull-right down"></span>
                                                    <a href='#Project_Details'/></h2>
                                                    <fieldset class="accordion-child" id="Project_Details">
                                                         <apex:outputpanel rendered="{!lAssignedResources.size==0}">
                                                            <apex:pageBlock >
                                                                <span class="content"><strong>No Resource Allocation</strong></span>
                                                            </apex:pageBlock> 
                                                         </apex:outputpanel>
                                                         <apex:outputPanel id="ResPanel">
                                                         <div class="related-list"> 
                                                            <apex:outputpanel rendered="{!lAssignedResources.size!=0}">
                                                            <apex:pageBlock >
                                                                        <apex:pageBlockTable value="{!lAssignedResources}" var="item">
                                                                            <apex:column value="{!item.DRDW_Resources__r.Name__r.Name}" />
                                                                                <!--<apex:facet name="header">Project Name</apex:facet>
                                                                                <apex:commandlink styleclass="remove-custom-data-row" value="{!item.Name}" action="{!EvalLink}">
                                                                                    <apex:param name="LinkID1" value="{!item.Id}" assignTo="{!LinkID1}" />
                                                                                </apex:commandlink>
                                                                            </apex:column>-->
                                                                            <apex:column value="{!item.Allocation_Start_Date__c}"/>
                                                                            <apex:column value="{!item.Allocation_End_Date__c}"/>
                                                                            <apex:column value="{!item.Hours_Per_Day__c}"/>
                                                                            <apex:column rendered="{!if(OR(isAdmin,isFin,isFunctionalHead),true,false)}">
                                                                            <apex:facet name="header">Remove</apex:facet>
                                                                                <apex:commandLink styleclass="remove-custom-data-row" value="Remove" action="{!deleteRes}" reRender="ResPanel">
                                                                                    <apex:param name="resId" value="{!item.id}" assignTo="{!resourseId}"/>
                                                                                </apex:commandLink>
                                                                            </apex:column>
                                                                        </apex:pageBlockTable>
                                                            </apex:pageBlock> 
                                                            </apex:outputpanel>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </fieldset>
                                                </div>
                                            </section>
                            <section class="row submit">
                                <div class="col-xs-12">
                                    <apex:outputPanel rendered="{!if(OR(isAdmin,isFin,AND(isFunctionalHead,isGroupUser),AND(isPmErl,isBUGroupUser),AND(isPmErl,isAccessable),AND(isSc,isAccessable)),true,false)}">
                                        <apex:commandButton styleClass="btn button" value="Edit" action="{!edit}"/>
                                    </apex:outputPanel>    
                                </div>
                            </section>
                </apex:form>
                </apex:outputPanel>  
                
        <!--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->      
                   <apex:outputpanel rendered="{!IF($CurrentPage.parameters.id != NULL,true,false) && IF($CurrentPage.parameters.isEdit =='true',true,false)}">
                           <apex:form Styleclass="create-study-form accordion">
                        <section class="row submit">
                                <div class="col-xs-12">
                                        <input type="button" class="btn button submit-form-button" value="Save"/>
                                    <apex:actionFunction Name="doSubmit" action="{!Save}"/>
                                    <!--apex:commandButton styleClass="btn button" value="Save" action="{!save}" /-->
                                    <apex:outputLink styleClass="btn button" value="/apex/DRDW_CreateERLRequest?id={!oActivity.DRDW_Request__c}&projid={!oActivity.Related_Project__c}">Cancel</apex:outputLink>
                                    
                                </div>
                            </section>
                            <apex:pageMessages />
                            <section class="row">
                                <div class="col-xs-12">
                                    <h2 class="accordion-parent">Details
                                    <span class = "mandatory-fields-indicator-badge"/>
                                        <span class="icon-large-caret pull-right down"></span></h2>
                                    <fieldset class="accordion-child">
                                        
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Title__c.Label}</label><span class="required-label"> *</span>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Title__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Title__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:inputField value="{!oActivity.Title__c}" styleclass="required"></apex:inputField>
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Status__c.Label}</label><span class="required-label"> *</span>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Status__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Status__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputField value="{!oActivity.Status__c}" styleclass="required"></apex:outputField>
                                            </div>
                                        </div>
                                        <apex:outputPanel id="capArea">
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Capability_Area__c.Label}</label><span class="required-label"> *</span>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Capability_Area__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Capability_Area__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                               <apex:selectList id="chooseField1" size="1" style="color:Black;" value="{!oActivity.Capability_Area__c}">
                                                    <apex:selectOptions value="{!lAreaPicklist}"/>
                                                   <apex:actionSupport action="{!UpdateArea}" event="onchange" reRender="capArea">                                                          
                                                   </apex:actionSupport> 
                                               </apex:selectList>
                                            </div> 
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Capability__c.Label}</label><span class="required-label"> *</span>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Capability__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Capability__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputPanel rendered="{!IF(oActivity.Capability_Area__c=='Other',true,false)}">
                                                    <apex:inputField value="{!oActivity.Capability__c}" styleclass="required"></apex:inputField>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!IF(oActivity.Capability_Area__c!='Other',true,false)}">
                                                    <apex:selectList id="chooseField2" size="1" style="color:Black;" value="{!oActivity.Capability__c}">
                                                        <apex:selectOptions value="{!lCapabilityPicklist}"/>                                                    
                                                   </apex:selectList>
                                               </apex:outputPanel>
                                            </div>
                                        </div>
                                        </apex:outputPanel>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Related_Project__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Related_Project__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Related_Project__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputLink value="{!IF(isIdea=true,'/apex/DRDW_CreateIdea?id='+oActivity.Related_Project__c+'&isEdit=false&section=#Project_Activities',IF(isGeneration=true,'/apex/DRDW_CreateGeneration?id='+oActivity.Related_Project__c+'&isEdit=false&section=#Project_Activities','/apex/DRDW_CreateAssessment?id='+oActivity.Related_Project__c+'&isEdit=false&section=#Project_Activities'))}">{!projectName}</apex:outputLink>
                                                <!-- <apex:outputField value="{!oActivity.Related_Project__c}"></apex:outputField>  -->
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>Related ERL Request</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.DRDW_Request__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.DRDW_Request__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <!-- <apex:outputField value="{!oActivity.DRDW_Request__c}"></apex:outputField> -->
                                                 <apex:outputLink value="/apex/DRDW_CreateERLRequest?id={!oActivity.DRDW_Request__c}&isEdit=false&projid={!oActivity.Related_Project__c}">{!oActivity.DRDW_Request__r.Name}</apex:outputLink>
                                                 
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Planned_Start_Date__c.Label}</label><span class="required-label"> *</span>
                                            </div>
                                            <div class="col-xs-3 field-wrapper hide-user-select left-aligned">
                                                <apex:inputField value="{!oActivity.Planned_Start_Date__c}" styleclass="required"/>
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Planned_End_Date__c.Label}</label><span class="required-label"> *</span>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Planned_End_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Planned_End_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper hide-user-select left-aligned">
                                                <apex:inputField value="{!oActivity.Planned_End_Date__c}" styleclass="required"></apex:inputField>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Actual_Start_Date__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Actual_Start_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Actual_Start_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:inputField value="{!oActivity.Actual_Start_Date__c}"></apex:inputField>
                                            </div>
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>{!$ObjectType.DRDW_Capability__c.Fields.Actual_End_Date__c.Label}</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Actual_End_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Actual_End_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:inputField value="{!oActivity.Actual_End_Date__c}" ></apex:inputField>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3 label-wrapper left-aligned">
                                                <label>Preferred Start Date</label>
                                                <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Capability__c.Fields.Proposed_Start_Date__c.inlinehelptext != NULL,true,false)}">
                                                    <div class="helpOrb tooltip-sfdc">
                                                        <span>{!$ObjectType.DRDW_Capability__c.Fields.Proposed_Start_Date__c.inlinehelptext}</span>
                                                    </div>          
                                                </apex:outputpanel>      
                                            </div>
                                            <div class="col-xs-3 field-wrapper left-aligned">
                                                <apex:outputPanel rendered="{!if(OR(AND(isGroupUser,isFunctionalHead),isFin,isAdmin),true,false)}">
                                                    
                                                    <apex:inputField value="{!oActivity.Proposed_Start_Date__c}"></apex:inputField>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!if(AND(AND(!isGroupUser,!isFunctionalHead),!isFin,!isAdmin),true,false)}">
                                                    <apex:outputField value="{!oActivity.Proposed_Start_Date__c}"></apex:outputField>
                                                </apex:outputPanel>
                                            </div>                                            
                                        </div>
                                    </fieldset>
                                </div>

                            
                            
                                    <div class="col-xs-12">
                                    <h2 class="accordion-parent">Related Activity Budget<span class="icon-large-caret pull-right down"></span>
                                        <a href='#Project_Budgets'/></h2>
                                    <fieldset class="accordion-child" id="Project_Budgets">
                                        <apex:outputPanel id="Budgetsection">
                                            
                                            <apex:outputpanel id="berror">
                                                <apex:outputpanel rendered="{!isbError}">
                                                    <div class="sfdc-errorMessage font-s">
                                                        <apex:pagemessages escape="false"></apex:pagemessages>
                                                    </div>
                                                </apex:outputpanel>
                                            </apex:outputpanel>
                                            <div class="accordion-content">
                                                <!--  Add new Experiment section starts -->
                                                <div class="row">
                                                    <div class="col-xs-3 label-wrapper left-aligned">
                                                        <label>Total PO Actuals</label>
                                                        <apex:outputpanel rendered="{!IF($ObjectType.DRDW_Project__c.Fields.Total_budget__c.inlinehelptext != NULL,true,false)}">
                                                            <div class="helpOrb tooltip-sfdc">
                                                                <span>{!$ObjectType.DRDW_Capability__c.Fields.Total_budget__c.inlinehelptext}</span>
                                                            </div>          
                                                        </apex:outputpanel>      
                                                    </div>
                                                    <apex:variable var="amount" value="{!oActivity.Total_budget__c}" />
                                                    <div class="{!IF((amount!= null && amount < 0),'currency-round-off col-xs-3 field-wrapper left-aligned red-color-text','currency-round-off col-xs-3 field-wrapper left-aligned')}">
                                                        <apex:outputText value="{!oActivity.Total_budget__c}">$</apex:outputText>
                                                    </div>
                                                    <div class="col-xs-6 zero-right-padding">
                                                       <apex:outputPanel rendered="{!if(OR(isAdmin,isFin),true,false)}">                                               
                                                        <apex:commandButton styleClass="btn button btn-create-new-related-item pull-right" value="Create New Activity Budget" action="{!AddBudgetCap}"/>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-3 label-wrapper left-aligned">
                                                        <label>Total Rolling Forecast</label>
                                                         
                                                    </div>
                                                    <apex:variable var="amount" value="{!totalforecast}" />
                                                    <div class="{!IF((amount!= null && amount < 0),'currency-round-off col-xs-3 field-wrapper left-aligned red-color-text','currency-round-off col-xs-3 field-wrapper left-aligned')}">
                                                        <apex:outputText value="{!totalforecast}">$</apex:outputText>
                                                    </div>
                                                </div>
                                                <!-- </fieldset> -->
                                                <!-- Add new Experiment section ends -->
                                                
                                                <!-- Iteration unit starts -->
                                                <apex:outputpanel id="theBudgetTable">
                                                <apex:outputpanel rendered="{!lbudgets.size>0}">
                                               
                                                <apex:pageBlock >
                                                            <apex:pageBlockTable value="{!lbudgets}" var="item">
                                                                <apex:column >
                                                                    <apex:facet name="header">Budget ID</apex:facet>
                                                                    <apex:commandlink styleclass="remove-custom-data-row" value="{!item.Name}" action="{!BudgetLink}">
                                                                        <apex:param name="LinkID2" value="{!item.Id}" assignTo="{!LinkID2}" />
                                                                    </apex:commandlink>
                                                                </apex:column>
                                                               <apex:column value="{!item.Titletab__c}"/>
                                                                <apex:column value="{!item.PO__c}"/>
                                                                
                                                                <apex:column value="{!item.Vendorr__c}"/>
                                                                <apex:column value="{!item.Scientist_Owner__c}"/>
                                                                  <apex:column >
                                                                      <apex:facet name="header">Total Contract Value</apex:facet>
                                                                      <apex:variable var="amount" value="{!item.Total_Contract_Value__c}" />
                                                                        <div class="{!IF((amount!= null && amount < 0),'currency-round-off red-color-text','currency-round-off')}">
                                                                             <apex:outputText value="{!item.Total_Contract_Value__c}">$</apex:outputText>
                                                                        </div>
                                                                  </apex:column>
                                                                  <apex:column >
                                                                      <apex:facet name="header">Total Actuals</apex:facet>
                                                                      <apex:variable var="amount" value="{!item.Total_Actuals__c}" />
                                                                        <div class="{!IF((amount!= null && amount < 0),'currency-round-off red-color-text','currency-round-off')}">
                                                                             <apex:outputText value="{!item.Total_Actuals__c}">$</apex:outputText>
                                                                        </div>
                                                                  </apex:column>
                                                                  <apex:column value="{!item.Cost_Center__r.Name}"/>
                                                              <apex:column rendered="{!if(OR(isAdmin,isFin),true,false)}">
                                                                    <apex:facet name="header">Action</apex:facet>
                                                                    <apex:commandlink styleclass="remove-custom-data-row" value="remove" action="{!Removebudget}" onclick="df_drdw.globalEvents.showWaitSpinner();" oncomplete="df_drdw.globalEvents.hideWaitSpinner();" rerender="theBudgetTable,noBudget,berror,Budgetsection">
                                                                        <apex:param name="genericID" value="{!item.Id}" assignTo="{!genericID}" />
                                                                    </apex:commandlink>
                                                                </apex:column>
                                                            </apex:pageBlockTable>
                                                </apex:pageBlock>
                                                </apex:outputpanel>
                                                </apex:outputpanel>
                                                <!-- Iteration unit ends -->    

                                                <!--No Experiment section startes -->
                                                <apex:outputpanel id="noBudget">
                                                    <apex:outputpanel rendered="{!lbudgets.size==0}">
                                                    <span class="content"><strong>No Activity Budget</strong></span>
                                                    </apex:outputpanel>
                                                </apex:outputpanel>   

                                                <!-- No Experiment section ends -->
                                            </div>    
                                        </apex:outputpanel> 
                                    </fieldset>
                                </div>
                                        
                                        
                                        
                             </section>

                            <!-------------- Related Evaluation Project starts ---------------- -->
                                <!-- <div class = "create-study-form accordion outside-form-section" > -->
                               
                                        <section class="row">
                                                <div class="col-xs-12">
                                                    <h2 class="accordion-parent">Resource Allocation<span class="icon-large-caret pull-right down"></span>
                                                    <a href='#Project_Details'/></h2>
                                                    <fieldset class="accordion-child" id="Project_Details">
                                                         <apex:outputpanel rendered="{!lAssignedResources.size==0}">
                                                            <apex:pageBlock >
                                                                <span class="content"><strong>No Resource Allocation</strong></span>
                                                            </apex:pageBlock> 
                                                         </apex:outputpanel>
                                                         <apex:outputPanel id="ResPanel">
                                                         <div class="related-list"> 
                                                            <apex:outputpanel rendered="{!lAssignedResources.size!=0}">
                                                            <apex:pageBlock >
                                                                        <apex:pageBlockTable value="{!lAssignedResources}" var="item">
                                                                            <apex:column value="{!item.DRDW_Resources__r.Name__r.Name}" />
                                                                                <!--<apex:facet name="header">Project Name</apex:facet>
                                                                                <apex:commandlink styleclass="remove-custom-data-row" value="{!item.Name}" action="{!EvalLink}">
                                                                                    <apex:param name="LinkID1" value="{!item.Id}" assignTo="{!LinkID1}" />
                                                                                </apex:commandlink>
                                                                            </apex:column>-->
                                                                            <apex:column value="{!item.Allocation_Start_Date__c}"/>
                                                                            <apex:column value="{!item.Allocation_End_Date__c}"/>
                                                                            <apex:column value="{!item.Hours_Per_Day__c}"/>
                                                                            <apex:column rendered="{!if(OR(isAdmin,isFin,isFunctionalHead),true,false)}">
                                                                            <apex:facet name="header">Remove</apex:facet>
                                                                                <apex:commandLink styleclass="remove-custom-data-row" value="Remove" action="{!deleteRes}" reRender="ResPanel">
                                                                                    <apex:param name="resId" value="{!item.id}" assignTo="{!resourseId}"/>
                                                                                </apex:commandLink>
                                                                            </apex:column>
                                                                        </apex:pageBlockTable>
                                                            </apex:pageBlock> 
                                                            </apex:outputpanel>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </fieldset>
                                                </div>
                                            </section>
                            <section class="row submit with-top-margin">
                                <div class="col-xs-12">
                                       <input type="button" class="btn button submit-form-button" value="Save"/>
                                    <apex:actionFunction Name="doSubmit" action="{!Save}"/>
                                    <!--apex:commandButton styleClass="btn button" value="Save" action="{!save}" /-->
                                    <apex:outputLink styleClass="btn button" value="/apex/DRDW_CreateERLRequest?id={!oActivity.DRDW_Request__c}&projid={!oActivity.Related_Project__c}">Cancel</apex:outputLink>
                                </div>
                            </section>
                </apex:form>
                    </apex:outputPanel> 
                </main>
                </div>
         </div>
         <c:DRDW_SR2_FooterComponent />
         <c:DRDW_QFOR_Scripts />
     </body> 
</apex:page>