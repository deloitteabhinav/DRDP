<apex:page sidebar="false" showHeader="false" standardStylesheets="false" action="{!executeWrapperGeneratorExport}" controller="DRDW_ERLProjectViewCtrl" extensions="DRDW_ERLResourceViewCtrl" cache="true" contentType="application/vnd.ms-excel#ERLResourceViewExport.xls" >

         <apex:pageBlock >
            <apex:pageBlockTable value="{!mEventDay}" var="oevent">
                <apex:column >
                    <apex:facet name="header">Resource Name</apex:facet>
                    <apex:outputField value="{!mEventDay[oevent].DRDW_Resource__r.Name__r.Name}"  />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Project Name</apex:facet>
                    <apex:outputField value="{!mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.DRDW_Request__r.Project__r.Name__c}"  />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Activity Title</apex:facet>
                    <apex:outputField value="{!mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Title__c}"  />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Activity Start Date</apex:facet>
                    <apex:outputField value="{!mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Actual_Start_Date__c}" rendered="{!if(mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Actual_Start_Date__c <> null,true,false)}" />
                    <apex:outputField value="{!mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Planned_Start_Date__c}" rendered="{!if(mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Actual_Start_Date__c == null,true,false)}" />                    
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Activity End Date</apex:facet>
                    <apex:outputField value="{!mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Actual_End_Date__c}" rendered="{!if(mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Actual_End_Date__c <> null,true,false)}" />
                    <apex:outputField value="{!mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Planned_End_Date__c}" rendered="{!if(mEventDay[oevent].DRDW_Event__r.DRDW_Activity__r.Actual_End_Date__c == null,true,false)}" />                    
                </apex:column>                
                <apex:column >
                    <apex:facet name="header">Allocation Date</apex:facet>
                    <apex:outputField value="{!mEventDay[oevent].Date__c}"  />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Hours</apex:facet>
                    <apex:outputField value="{!mEventDay[oevent].Allocated_Hours__c}"  />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Cumulative Allocation Percentage</apex:facet>
                    <apex:variable value="{!mEventDay[oevent].DRDW_Resource__c}" var="resourceId"/>
                    <apex:variable value="{!mEventDay[oevent].Date__c}" var="datebvar"/>
                    <!--<apex:variable value="{!mEventDay[oevent].DRDW_Resource__r.Hours_Available_Per_Day__c}" var="hoursperday"/>
                    <apex:outputText value="{!if(hoursperday!=0 && mRoasterPerDayAllocation[resourceId][datebvar] != null,Round((mRoasterPerDayAllocation[resourceId][datebvar])*100,0)/hoursperday,0)}"  /> -->
                    <apex:outputText value="{!mRoasterPerDayAllocationPer[resourceId][datebvar]}" />
                </apex:column>
            </apex:pageBlockTable>
        </apex:pageBlock>
    
    
</apex:page>